<?xml version="1.0" encoding="utf-8"?>
<!--
////////////////////////////////////////////////////////////////////////////////
//
// Copyright (c) 2010-2011 Esri
//
// All rights reserved under the copyright laws of the United States.
// You may freely redistribute and use this software, with or
// without modification, provided you include the original copyright
// and use restrictions.  See use restrictions in the file:
// <install location>/License.txt
//
////////////////////////////////////////////////////////////////////////////////
-->
<s:Skin xmlns:fx="http://ns.adobe.com/mxml/2009"
		xmlns:s="library://ns.adobe.com/flex/spark"
		xmlns:esri="http://www.esri.com/2008/ags"
		layoutDirection="ltr">
	
	<fx:Metadata>
		[HostComponent("com.esri.viewer.managers.MapManager")]
	</fx:Metadata>
	
	<fx:Script>
		<![CDATA[
			import com.esri.viewer.AppEvent;
			
			
			protected function btnTest1_clickHandler(event:MouseEvent):void {
				AppEvent.dispatch( AppEvent.ADD_LINES, '{"type":"oneWayStreet","lines":[{"id":"111","geometry":{"paths":[[[104.06675,30.63736],[104.07106,30.6373],[104.07571,30.63644]]]}}]}' );
//				AppEvent.dispatch( AppEvent.ADD_LINES, '{"type":"oneWayStreet","lines":[{"id":"O2014061700000053","geometry":{"paths":[[[104.06675,30.63736],[104.07106,30.6373],[104.07571,30.63644]]]},"fields":{"roadSectNames":"双林路","laneCount":"两车道","id":"O2014061700000053","isReverse":"1","symbolCount":2,"roadType":"fixed","roadNature":"支路","belongSuboffice":"一分局","code":"1002","enableReason":"1111","enableTime":"2014-06-01","roadName":"林荫路单行道"}}]}');
//				AppEvent.dispatch( AppEvent.START_ADD_OVERLAY, "oneWayStreet" );
//				AppEvent.dispatch( AppEvent.ADD_POINTS, '{"type":"orcLocate","points":[{"fields":{"duty":"民警","policeCode":"071333","policeGpsCode":"8008429","policeName":"阮闽","deptCode":"00","deptGpsCode":"00","deptName":"交通管理局","teamCode":"DPT00-02","teamGpsCode":"DPT00-02","teamName":"勤务处","status":"0"},"id":"071333","x":103.95958,"y":30.58108},{"fields":{"duty":"民警","policeCode":"004789","policeGpsCode":"8011139","policeName":"刘洪明","deptCode":"01","deptGpsCode":"01","deptName":"一分局","teamCode":"DPT01-01","teamGpsCode":"DPT01-01","teamName":"一大队","status":"0"},"id":"004789","x":104.03952,"y":30.59808}]}' );
//				AppEvent.dispatch( AppEvent.ADD_BUFFERS, '{"type":"case","id":"12345","distance":500,"geometry":{"x":103.95958,"y":30.58108}}' );
//				AppEvent.dispatch( AppEvent.CHANGE_WIDGET_ACTIVITY, { name: "新增安保方案", visible: true } );
//				AppEvent.dispatch( AppEvent.SET_SEARCH_TEXT, "1111" );
				
//				AppEvent.dispatch( AppEvent.TRACE_PLAYBACK, '<points><type>Police</type><point><id>2</id><x>104.04703</x><y>30.62609</y><name>辜小雨</name><time>2014-07-07 07:30:46</time></point><point><id>3</id><x>104.04756</x><y>30.62733</y><picurl></picurl><name>辜小雨</name><time>2014-07-07 07:31:06</time></point><point><id>4</id><x>104.05649</x><y>30.64126</y><name>辜小雨</name><time>2014-07-07 07:33:59</time></point><point><id>5</id><x>104.05858</x><y>30.65103</y><name>辜小雨</name><time>2014-07-07 07:36:56</time></point><point><id>6</id><x>104.06187</x><y>30.64944</y><name>辜小雨</name><time>2014-07-07 08:07:03</time></point><point><id>7</id><x>104.06187</x><y>30.64944</y><name>辜小雨</name><time>2014-07-07 08:07:24</time></point><point><id>8</id><x>104.06476</x><y>30.6473</y><name>辜小雨</name><time>2014-07-07 08:10:02</time></point><point><id>9</id><x>104.0661</x><y>30.64622</y><name>辜小雨</name><time>2014-07-07 08:16:03</time></point><point><id>10</id><x>104.06622</x><y>30.64359</y><name>辜小雨</name><time>2014-07-07 08:19:04</time></point><point><id>11</id><x>104.06107</x><y>30.64765</y><name>辜小雨</name><time>2014-07-07 08:22:06</time></point><point><id>12</id><x>104.06255</x><y>30.64767</y><name>辜小雨</name><time>2014-07-07 08:24:50</time></point><point><id>13</id><x>104.06319</x><y>30.64613</y><name>辜小雨</name><time>2014-07-07 08:38:13</time></point><point><id>14</id><x>104.06575</x><y>30.6473</y><name>辜小雨</name><time>2014-07-07 08:40:09</time></point></points>' );
			}
			
			protected function btnTest2_clickHandler(event:MouseEvent):void {
//				AppEvent.dispatch( AppEvent.CHANGE_WIDGET_ACTIVITY, { name: "发布段", visible: true } );
//				AppEvent.dispatch( AppEvent.WIDGET_RUN, "发布段" );

//				AppEvent.dispatch( AppEvent.CHANGE_WIDGET_ACTIVITY, { name: "显示安保方案", visible: true } );
//				AppEvent.dispatch( AppEvent.FIND_DEVICE, { type: "oneWayStreetShow", id: "O2014061700000053" } );
//				AppEvent.dispatch( AppEvent.START_MOVE_OVERLAY, '{"type":"oneWayStreet","ids":["O2014061700000053"]}'  );
//				AppEvent.dispatch( AppEvent.ADD_POINTS, '{"type":"caseAccidentLocate","points":[{"fields":{"taskSourceId":"民警","businessStateId":"071333","caseId":"8008429","callPoliceTime":"阮闽","callPolicePhone":"00","occurPlace":"00"},"id":"071333","x":103.95958,"y":30.58108}]}' );
//				AppEvent.dispatch( AppEvent.START_MOVE_OVERLAY, '{"type":"caseAccidentLocate","ids":["071333"]}' );
//				AppEvent.dispatch( AppEvent.FIND_DEVICE, { name: "caseAccidentLocate", id: "071333" } );
//				AppEvent.dispatch( AppEvent.DELETE_ALL_BUFFERS, "case" );
				AppEvent.dispatch( AppEvent.FIND_DEVICE, {"type": "carTrackPoint", "id": "2"} );
			}
			
			protected function btnTest3_clickHandler(event:MouseEvent):void {
//				AppEvent.dispatch( AppEvent.CHANGE_WIDGET_ACTIVITY, { name: "发布段", visible: false } );
//				AppEvent.dispatch( AppEvent.WIDGET_CLOSE, "发布段" );

//				AppEvent.dispatch( AppEvent.CHANGE_WIDGET_ACTIVITY, { name: "新增安保方案", visible: false } );
//				AppEvent.dispatch( AppEvent.CHANGE_WIDGET_ACTIVITY, { name: "显示安保方案", visible: false } );
//				AppEvent.dispatch( AppEvent.DELETE_BUFFERS, '{"type":"case","ids":["12345"]}' );
			}
			
		]]>
	</fx:Script>
	
	
	<s:states>
		<s:State name="normal"/>
		<s:State name="decorated"/>
		<s:State name="resized"/>
		<s:State name="disabled"/>
	</s:states>
	
	<s:transitions>
		<s:Transition id="toresize" fromState="*" toState="resized">
			<s:Move duration="500" target="{map}"/>
		</s:Transition>
	</s:transitions>
	
	<s:Group id="managerView" width="100%" height="100%">
		<!-- Start map at size 0 so that only one extentChange is fired after it's been sized and had its extent set. -->
		<esri:Map id="map" width="0" height="0" zoomSliderVisible="false"
				  left.resized="{hostComponent.mapLeft}" right.resized="{hostComponent.mapRight}"
				  top.resized="{hostComponent.mapTop}" bottom.resized="{hostComponent.mapBottom}"
				  infoWindowRendererHighlightColor="{getStyle('selectionColor')}"/>
	</s:Group>
	
	<s:HGroup right="10" bottom="10" visible="true">
		<s:Button id="btnTest1" label="test1" click="btnTest1_clickHandler(event)"/>
		<s:Button id="btnTest2" label="test2" click="btnTest2_clickHandler(event)"/>
		<s:Button id="btnTest3" label="test3" click="btnTest3_clickHandler(event)"/>
	</s:HGroup>
</s:Skin>
