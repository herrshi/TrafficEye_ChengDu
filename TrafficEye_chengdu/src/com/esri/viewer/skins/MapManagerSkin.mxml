<?xml version="1.0" encoding="utf-8"?>
<!--
////////////////////////////////////////////////////////////////////////////////
//
// Copyright (c) 2010-2011 Esri
//
// All rights reserved under the copyright laws of the United States.
// You may freely redistribute and use this software, with or
// without modification, provided you include the original copyright
// and use restrictions.  See use restrictions in the file:
// <install location>/License.txt
//
////////////////////////////////////////////////////////////////////////////////
-->
<s:Skin xmlns:fx="http://ns.adobe.com/mxml/2009"
		xmlns:s="library://ns.adobe.com/flex/spark"
		xmlns:esri="http://www.esri.com/2008/ags"
		layoutDirection="ltr">
	
	<fx:Metadata>
		[HostComponent("com.esri.viewer.managers.MapManager")]
	</fx:Metadata>
	
	<fx:Script>
		<![CDATA[
			import com.esri.viewer.AppEvent;
			
			
			protected function btnTest1_clickHandler(event:MouseEvent):void {
//				AppEvent.dispatch( AppEvent.ADD_LINES, '{"type":"oneWayStreet","lines":[{"id":"1","geometry":{"paths":[[[103.95958,30.58108],[104.03952,30.59808]]]},"fields":{"name":"111","id":"222"}}]}');
//				AppEvent.dispatch( AppEvent.START_ADD_OVERLAY, "caseAccidentLocate" );
//				AppEvent.dispatch( AppEvent.ADD_POINTS, '{"type":"police","points":[{"fields":{"duty":"民警","policeCode":"071333","policeGpsCode":"8008429","policeName":"阮闽","deptCode":"00","deptGpsCode":"00","deptName":"交通管理局","teamCode":"DPT00-02","teamGpsCode":"DPT00-02","teamName":"勤务处","status":"0"},"id":"071333","x":103.95958,"y":30.58108},{"fields":{"duty":"民警","policeCode":"004789","policeGpsCode":"8011139","policeName":"刘洪明","deptCode":"01","deptGpsCode":"01","deptName":"一分局","teamCode":"DPT01-01","teamGpsCode":"DPT01-01","teamName":"一大队","status":"0"},"id":"004789","x":104.03952,"y":30.59808}]}' );
				AppEvent.dispatch( AppEvent.ADD_BUFFERS, '{"type":"case","id":"12345","distance":500,"geometry":{"x":103.95958,"y":30.58108}}' );
//				AppEvent.dispatch( AppEvent.CHANGE_WIDGET_ACTIVITY, { name: "新增安保方案", visible: true } );
				
			}
			
			protected function btnTest2_clickHandler(event:MouseEvent):void {
//				AppEvent.dispatch( AppEvent.CHANGE_WIDGET_ACTIVITY, { name: "显示安保方案", visible: true } );
//				AppEvent.dispatch( AppEvent.FIND_DEVICE, { name: "police", id: "071333" } );
//				AppEvent.dispatch( AppEvent.ADD_POINTS, '{"type":"caseAccidentLocate","points":[{"fields":{"taskSourceId":"民警","businessStateId":"071333","caseId":"8008429","callPoliceTime":"阮闽","callPolicePhone":"00","occurPlace":"00"},"id":"071333","x":103.95958,"y":30.58108}]}' );
//				AppEvent.dispatch( AppEvent.START_MOVE_OVERLAY, '{"type":"caseAccidentLocate","ids":["071333"]}' );
//				AppEvent.dispatch( AppEvent.FIND_DEVICE, { name: "caseAccidentLocate", id: "071333" } );
				AppEvent.dispatch( AppEvent.DELETE_ALL_BUFFERS, "case" );
			}
			
			protected function btnTest3_clickHandler(event:MouseEvent):void {
//				AppEvent.dispatch( AppEvent.CHANGE_WIDGET_ACTIVITY, { name: "新增安保方案", visible: false } );
//				AppEvent.dispatch( AppEvent.CHANGE_WIDGET_ACTIVITY, { name: "显示安保方案", visible: false } );
				AppEvent.dispatch( AppEvent.DELETE_BUFFERS, '{"type":"case","ids":["12345"]}' );
			}
			
		]]>
	</fx:Script>
	
	
	<s:states>
		<s:State name="normal"/>
		<s:State name="decorated"/>
		<s:State name="resized"/>
		<s:State name="disabled"/>
	</s:states>
	
	<s:transitions>
		<s:Transition id="toresize" fromState="*" toState="resized">
			<s:Move duration="500" target="{map}"/>
		</s:Transition>
	</s:transitions>
	
	<s:Group id="managerView" width="100%" height="100%">
		<!-- Start map at size 0 so that only one extentChange is fired after it's been sized and had its extent set. -->
		<esri:Map id="map" width="0" height="0" zoomSliderVisible="false"
				  left.resized="{hostComponent.mapLeft}" right.resized="{hostComponent.mapRight}"
				  top.resized="{hostComponent.mapTop}" bottom.resized="{hostComponent.mapBottom}"
				  infoWindowRendererHighlightColor="{getStyle('selectionColor')}"/>
	</s:Group>
	
	<s:HGroup right="10" bottom="10" visible="false">
		<s:Button id="btnTest1" label="test1" click="btnTest1_clickHandler(event)"/>
		<s:Button id="btnTest2" label="test2" click="btnTest2_clickHandler(event)"/>
		<s:Button id="btnTest3" label="test3" click="btnTest3_clickHandler(event)"/>
	</s:HGroup>
</s:Skin>
